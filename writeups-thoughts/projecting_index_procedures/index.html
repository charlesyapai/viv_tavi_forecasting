<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projecting Index Procedures | TAVI & SAVR Forecasting</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    
    <!-- MathJax for rendering equations -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <div class="layout-wrapper">
        <aside class="sidebar">
            <nav class="toc">
                <h3>Contents</h3>
                <ul>
                    <li><a href="#overview">Overview</a></li>
                    <li><a href="#step1">Step 1: Data Overview</a></li>
                    <li><a href="#step2">Step 2: Normalization</a></li>
                    <li><a href="#step3">Step 3: Risk Trends</a></li>
                    <li><a href="#step4">Step 4: TAM Derivation</a></li>
                    <li><a href="#step5">Step 5: TAVI Adoption</a></li>
                    <li><a href="#step6">Step 6: SAVR Residual</a></li>
                    <li><a href="#summary">Summary Output</a></li>
                </ul>
            </nav>
        </aside>

        <main class="container">
            <header>
                <h1>Projecting Index Procedures</h1>
                <p>A comprehensive statistical framework for forecasting Transcatheter Aortic Valve Implantation (TAVI) and Surgical Aortic Valve Replacement (SAVR) volumes in South Korea through 2050.</p>
            </header>

            <section id="overview" class="section">
                <h2>Overview</h2>
                <p>This document details the complete statistical framework used to forecast TAVI and SAVR volumes. The model integrates demographic projections, procedure-specific risk trends, and infrastructure constraints to produce a robust demand-supply forecast. The method is divided into six distinct analytical steps.</p>
                <p>The core implementation is found in <code>simulation_run_v1/models/final_adoption_model.py</code>, using <code>scipy.optimize.curve_fit</code> and <code>numpy.polyfit</code> for the core regressions.</p>
            </section>

            <section id="step1" class="section">
                <h2>Step 1: Data Overview & Problem Statement</h2>
                
                <h3>The Raw Data Pattern</h3>
                <p>The raw procedure data exhibits varying volatility, particularly during the COVID-19 pandemic window (\(W = [2020, 2021, 2022, 2023]\)). A simple visual inspection reveals a "slow start" from 2015, a "sharp spike" in 2023, and a "slight dip" in 2024.</p>

                <figure>
                    <img src="official_report/step1_data_overview.png" alt="Data Overview showing raw procedure counts">
                    <figcaption>Figure 1: Data Overview. Note the dip and subsequent spike during the pandemic years. Breakdown by key demographic segments (80+ vs 50-79).</figcaption>
                </figure>
            </section>

            <section id="step2" class="section">
                <h2>Step 2: Data Normalization (Volume-Preserved Trend Redistribution)</h2>
                
                <h3>Calculation Logic</h3>
                <p>To prepare this volatile data for long-term trend analysis, we implement a mass-conservation algorithm to reshape the pandemic volatility into a smooth signal.</p>
                
                <h4>1. Pre-COVID Trend Fitting</h4>
                <p>We perform a linear regression (Order-1 Polynomial) on the observed data from 2012–2019 using <code>numpy.polyfit</code>.</p>
                <div class="math-block">
                    $$ E_{trend}(t) = \alpha + \beta t $$
                </div>

                <h4>2. Volume Comparison (The Scalar)</h4>
                <p>We compare the integral (sum) of the <em>Observed</em> procedures vs. the <em>Expected</em> trend procedures during the specific window [2020, 2023].</p>
                <div class="math-block">
                    $$ k = \frac{\sum_{t=2020}^{2023} O(t)}{\sum_{t=2020}^{2023} E_{trend}(t)} $$
                </div>
                <p>In our dataset, this scalar \(k \approx 1.07\). This indicates that despite the "dip", the total volume of patients treated in the 4-year block was actually 7% <em>higher</em> than what the pre-2019 linear trend predicted.</p>

                <h4>3. Redistribution</h4>
                <p>The normalized series \(N(t)\) for the window is generated by applying this scalar to the smooth trend line.</p>
                <div class="math-block">
                    $$ N(t) = k \times E_{trend}(t) $$
                </div>
                <p>This ensures the model sees a smooth, monotonically increasing curve that mathematically preserves every single patient treated during the pandemic.</p>

                <figure>
                    <img src="official_report/step2_normalization_effect.png" alt="Normalization Effect">
                    <figcaption>Figure 2: The Blue Line (Normalized) preserves the area under the curve of the Black Dashed Line (Raw).</figcaption>
                </figure>
            </section>

            <section id="step3" class="section">
                <h2>Step 3: Age-Stratified Risk Trend Modeling</h2>
                
                <h3>Rationale</h3>
                <p>We model the "Risk Rate" (procedures per 100,000 population) for age bands (50-54, ..., 80+). We avoid linear models to prevent projecting infinite disease prevalence.</p>

                <h3>Calculation Logic</h3>
                <p>We fit a logarithmic function to the normalized risk rates using <code>scipy.optimize.curve_fit</code>. The optimizer solves for parameters \(\alpha\) and \(\beta\) that minimize the least-squares error.</p>
                
                <div class="math-block">
                    $$ R_{i}(t) = \alpha_{i} + \beta_{i} \ln(t - 2010) $$
                </div>

                <ul>
                    <li><strong>Logarithmic Basis:</strong> We fix the offset at \(t_{0}=2010\) (near the start of the TAVI era in Korea).</li>
                    <li><strong>Validation:</strong> The code checks if there are at least 3 valid data points; otherwise, it falls back to a simple mean.</li>
                </ul>

                <figure>
                    <img src="official_report/step3_projected_risk_trends.png" alt="Projected Risk Trends">
                    <figcaption>Figure 3: Older cohorts (75-79, 80+) show steep initial growth ($\beta_{high}$), while younger cohorts show flatter trajectories.</figcaption>
                </figure>
            </section>

            <section id="step4" class="section">
                <h2>Step 4: Total Addressable Market (TAM) Derivation</h2>
                
                <h3>Demographic Integration</h3>
                <p>The TAM is calculated via a granular "Bottom-Up" summation loop, interacting the risk rates with UN Population Projections at the cohort level.</p>

                <h3>Calculation Logic</h3>
                <p>For every simulated year \(t \in [2025, 2050]\):</p>
                <div class="math-block">
                    $$ \text{TAM}(t) = \sum_{cohorts} \left( \text{Pop}_{i}(t) \times R_{i}(t) \right) $$
                </div>
                
                <p>The code specifically performs this vector multiplication for the bands: 50-54, 55-59, 60-64, 65-69, 70-74, 75-79, and \(\geq\)80.</p>

                <div class="callout">
                    <strong>Mechanism of Growth:</strong> The output verifies that while \(R_{i}(t)\) flattens (logarithmic saturation), \(\text{TAM}(t)\) grows exponentially. This is driven entirely by the demographic term \(\text{Pop}_{80+}(t)\), which is projected to triple. The model confirms that <strong>demography, not clinical volatility, is the primary long-term driver</strong>.
                </div>

                <figure>
                    <img src="official_report/step4_projected_tam.png" alt="TAM Projection">
                    <figcaption>Figure 4: Note the strong correlation between TAM (Black) and the raw 80+ Population count (Green).</figcaption>
                </figure>
            </section>

            <section id="step5" class="section">
                <h2>Step 5: Demographically Adjusted TAVI Adoption</h2>
                
                <h3>Methodology & Rationale</h3>
                <p>The patterns observed in the TAVI data—a slow start from 2015, a sharp spike in 2023, and a slight dip in 2024—are consistent with the <strong>"Diffusion of Innovation"</strong> model often used for medical technologies, but are heavily distorted by regulatory and reimbursement shocks specific to South Korea.</p>

                <div class="callout">
                    <h4>Real-World Context: Literature & Policy Evidence</h4>
                    
                    <p><strong>1. The "Slow Start" (2015–2021)</strong><br>
                    While TAVI was introduced in Korea circa 2010, the NHIS only began partial reimbursement (20%) in June 2015. For years, patients were liable for 80% of the procedure cost (approx. 30 million KRW) out-of-pocket. This significant financial barrier artificially suppressed the "rapid growth" phase of adoption, keeping volumes lower than clinically expected compared to other developed markets.</p>

                    <p><strong>2. The "Sharp Spike" (2023)</strong><br>
                    This surge is directly linked to a major policy change in May 2022. The Ministry of Health and Welfare expanded coverage significantly, reducing the copay from 80% to just 5% for patients over 80 years old and high-risk groups. This instantly unlocked a <strong>"Bolus Effect"</strong>: a multi-year backlog of clinically eligible but financially constrained elderly patients suddenly entered the system. The 2023 data represents the clearing of this accumulated demand.</p>

                    <p><strong>3. The "Dip" (2024)</strong><br>
                    This reflects <strong>"Post-Bolus Stabilization."</strong> Once the backlog of waiting elderly patients was treated in late 2022 and 2023, market volume naturally dropped back to the "incidence rate" (newly diagnosed patients per year) rather than the "prevalence rate" (everyone who has the disease). This dip confirms that 2023 was an anomaly, not the permanent new trajectory.</p>
                </div>

                <h3>Summary of Approach</h3>
                <p>To forecast future adoption accurately, we must disentangle these one-time regulatory distortions from the underlying technology adoption curve. We perform four distinct steps:</p>
                <ol>
                    <li><strong>Redistribution:</strong> Remove pandemic noise from the TAVI series.</li>
                    <li><strong>Demographic Adjustment:</strong> Normalize volumes to a fixed 2024 population structure. This isolates the "intrinsic" intent to treat, removing the noise of the rapidly aging population from the core adoption signal.</li>
                    <li><strong>Sigmoid Fitting:</strong> Fit a logistic curve to this adjusted series. <strong>Crucially, we fix the midpoint at 2023</strong>. Mathematically, if 2023 was the peak of the "Bolus" clearing, it represents the inflection point where the curve switches from accelerating to decelerating.</li>
                    <li><strong>Re-introduction:</strong> We then multiply this clean adoption curve by the actual projected demographic growth of the 80+ population. This gives us the final forecast: a stable adoption rate applied to an explosively growing population.</li>
                </ol>

                <hr style="border: 0; border-top: 1px solid var(--border-color); margin: 3rem 0;">

                <h4>Step 5.1: Focused TAVI Redistribution</h4>
                <p>We first apply our volume-preserved redistribution logic strictly to the TAVI subset to ensure the adoption model is trained on a smooth signal.</p>
                <figure>
                   <img src="official_report/step5_tavi_redistribution.png" alt="TAVI Redistribution">
                   <figcaption>Figure 5a: Focused Redistribution for TAVI volumes.</figcaption>
               </figure>

                <h4>Step 5.2: Demographic Adjustment (Direct Standardization)</h4>
                <p>We calculate what the historical TAVI volume <em>would have been</em> if the population structure had remained fixed at 2024 levels. This isolates the pure "technology adoption" signal.</p>
                <div class="math-block">
                    $$ V_{adj}(t) = \sum_{age} \left( \frac{V_{obs}(t, age)}{Pop(t, age)} \times Pop(2024, age) \right) $$
                </div>
                 <figure>
                    <img src="official_report/step5_demographic_adjustment.png" alt="Demographic Adjustment">
                    <figcaption>Figure 5b: The Green Line (Adjusted) removes the "demographic tailwind," revealing the intrinsic procedure adoption.</figcaption>
                </figure>

                <h4>Step 5.3: Sigmoid Projection</h4>
                <p>We fit a Sigmoid (Logistic) curve to this <em>Adjusted Volume</em> series.</p>
                <div class="math-block">
                    $$ V_{sigmoid}(t) = \frac{L}{1 + e^{-k(t - 2023)}} $$
                </div>
                <figure>
                    <img src="official_report/step5_tavi_sigmoid_fit.png" alt="Sigmoid Fit">
                    <figcaption>Figure 5c: Sigmoid fit anchored at the 2023 reimbursement shock.</figcaption>
                </figure>

                <h4>Step 5.4: Demographic Re-Introduction</h4>
                <p>The final TAVI forecast is obtained by multiplying the Sigmoid projection by the projected demographic growth multiplier relative to 2024.</p>
                <div class="math-block">
                    $$ F_{tavi}(t) = V_{sigmoid}(t) \times \frac{\sum (R_{2024} \cdot Pop(t))}{\sum (R_{2024} \cdot Pop(2024))} $$
                </div>

                <figure>
                    <img src="official_report/step5_demographic_impact.png" alt="Demographic Impact Comparison">
                    <figcaption>Figure 5d: <strong>Impact of Aging Population.</strong> The Green Dashed line is the Sigmoid (Fixed Pop). The Blue Solid line is the Final Forecast. The difference is driven by the rapid growth of the 80+ population (Purple Dotted Line).</figcaption>
                </figure>
            </section>

            <section id="step6" class="section">
                <h2>Step 6: SAVR Residual Calculation</h2>
                
                <h3>Substitution Interaction</h3>
                <p>The model treats Surgical Aortic Valve Replacement (SAVR) as the "Residual Demand" that fills the gap between biological need (TAM) and TAVI capacity.</p>

                <h3>Calculation Logic</h3>
                <p>For each year, the SAVR volume is strictly derived as:</p>
                <div class="math-block">
                    $$ S(t) = \max \left( 0, \ \text{TAM}(t) - F_{tavi}(t) \right) $$
                </div>

                <p><strong>Implication:</strong> This coupling ensures the two modalities are not forecasted in isolation.</p>
                <ul>
                    <li>If TAVI capacity grows rapidly, it "cannibalizes" the TAM, driving SAVR down.</li>
                    <li>If TAVI centers saturate (as predicted in Step 5), the TAVI curve flattens. Meanwhile, the TAM continues to rise due to demographics.</li>
                    <li><strong>Result:</strong> The "excess" patients spill over into the SAVR residual, causing SAVR volumes to stabilize or even rebound in the long term (2040s).</li>
                </ul>

                <figure>
                    <img src="official_report/step6_final_projection.png" alt="Final Market Projection">
                    <figcaption>Figure 6: Final Market Projection. Black Dashed = TAM; Blue = TAVI (Variant Forecast); Red = SAVR (Residual Gap).</figcaption>
                </figure>
            </section>


            <a href="../viv_tavi_mc_projection/index.html" class="nav-button">
                Proceed to Monte Carlo Projection of ViV TAVI Rates &rarr;
            </a>
        </main>
    </div>
</body>
</html>
